Logging to file:  /rds/general/user/zf923/home/hat/log/at-cifar10-1/log-train.log
Using device: cuda
Files already downloaded and verified
Files already downloaded and verified
attack_eps= 0.00392156862745098
attack_step= 0.000980392156862745



Standard training for 0 epochs



Standard Accuracy-	Test: 9.257812%.
Adversarial training for 100 epochs
======= Epoch 1 =======
Loss: 1.5209.	LR: 0.0084
Standard Accuracy-	Test: 56.49%.
Adversarial Accuracy-	Train: 43.70%.
Time taken: 0:02:22
======= Epoch 2 =======
Loss: 1.1279.	LR: 0.0092
Standard Accuracy-	Test: 67.88%.
Adversarial Accuracy-	Train: 59.10%.
Time taken: 0:02:22
======= Epoch 3 =======
Loss: 0.9631.	LR: 0.0116
Standard Accuracy-	Test: 73.39%.
Adversarial Accuracy-	Train: 65.45%.
Time taken: 0:02:22
======= Epoch 4 =======
Loss: 0.8714.	LR: 0.0155
Standard Accuracy-	Test: 62.10%.
Adversarial Accuracy-	Train: 68.86%.
Time taken: 0:02:22
======= Epoch 5 =======
Loss: 0.8114.	LR: 0.0209
Standard Accuracy-	Test: 73.80%.
Adversarial Accuracy-	Train: 70.96%.
Time taken: 0:02:22
======= Epoch 6 =======
Loss: 0.7629.	LR: 0.0277
Standard Accuracy-	Test: 76.46%.
Adversarial Accuracy-	Train: 72.84%.
Time taken: 0:02:22
======= Epoch 7 =======
Loss: 0.7285.	LR: 0.0357
Standard Accuracy-	Test: 78.23%.
Adversarial Accuracy-	Train: 74.04%.
Time taken: 0:02:22
======= Epoch 8 =======
Loss: 0.6980.	LR: 0.0450
Standard Accuracy-	Test: 80.45%.
Adversarial Accuracy-	Train: 75.05%.
Time taken: 0:02:22
======= Epoch 9 =======
Loss: 0.6676.	LR: 0.0552
Standard Accuracy-	Test: 80.46%.
Adversarial Accuracy-	Train: 76.32%.
Time taken: 0:02:22
======= Epoch 10 =======
Loss: 0.6507.	LR: 0.0663
Standard Accuracy-	Test: 81.35%.
Adversarial Accuracy-	Train: 76.91%.
Time taken: 0:02:22
======= Epoch 11 =======
Loss: 0.6297.	LR: 0.0781
Standard Accuracy-	Test: 81.56%.
Adversarial Accuracy-	Train: 77.73%.
Time taken: 0:02:22
======= Epoch 12 =======
Loss: 0.6273.	LR: 0.0903
Standard Accuracy-	Test: 75.66%.
Adversarial Accuracy-	Train: 77.90%.
Time taken: 0:02:22
======= Epoch 13 =======
Loss: 0.6201.	LR: 0.1029
Standard Accuracy-	Test: 82.34%.
Adversarial Accuracy-	Train: 78.08%.
Time taken: 0:02:22
======= Epoch 14 =======
Loss: 0.6150.	LR: 0.1155
Standard Accuracy-	Test: 71.37%.
Adversarial Accuracy-	Train: 78.37%.
Time taken: 0:02:22
======= Epoch 15 =======
Loss: 0.6165.	LR: 0.1281
Standard Accuracy-	Test: 80.01%.
Adversarial Accuracy-	Train: 78.05%.
Time taken: 0:02:22
======= Epoch 16 =======
Loss: 0.6092.	LR: 0.1404
Standard Accuracy-	Test: 82.26%.
Adversarial Accuracy-	Train: 78.55%.
Time taken: 0:02:22
======= Epoch 17 =======
Loss: 0.6024.	LR: 0.1521
Standard Accuracy-	Test: 82.68%.
Adversarial Accuracy-	Train: 78.72%.
Time taken: 0:02:22
======= Epoch 18 =======
Loss: 0.6019.	LR: 0.1632
Standard Accuracy-	Test: 79.68%.
Adversarial Accuracy-	Train: 78.77%.
Time taken: 0:02:22
======= Epoch 19 =======
Loss: 0.5954.	LR: 0.1735
Standard Accuracy-	Test: 80.40%.
Adversarial Accuracy-	Train: 78.92%.
Time taken: 0:02:22
======= Epoch 20 =======
Loss: 0.5957.	LR: 0.1827
Standard Accuracy-	Test: 82.77%.
Adversarial Accuracy-	Train: 79.02%.
Time taken: 0:02:22
======= Epoch 21 =======
Loss: 0.5904.	LR: 0.1908
Standard Accuracy-	Test: 79.33%.
Adversarial Accuracy-	Train: 79.13%.
Time taken: 0:02:22
======= Epoch 22 =======
Loss: 0.5891.	LR: 0.1975
Standard Accuracy-	Test: 81.37%.
Adversarial Accuracy-	Train: 79.12%.
Time taken: 0:02:22
======= Epoch 23 =======
Loss: 0.5822.	LR: 0.2029
Standard Accuracy-	Test: 82.38%.
Adversarial Accuracy-	Train: 79.48%.
Time taken: 0:02:22
======= Epoch 24 =======
Loss: 0.5813.	LR: 0.2068
Standard Accuracy-	Test: 72.45%.
Adversarial Accuracy-	Train: 79.45%.
Time taken: 0:02:22
======= Epoch 25 =======
Loss: 0.5774.	LR: 0.2092
Standard Accuracy-	Test: 78.78%.
Adversarial Accuracy-	Train: 79.54%.
Time taken: 0:02:22
======= Epoch 26 =======
Loss: 0.5751.	LR: 0.2100
Standard Accuracy-	Test: 82.52%.
Adversarial Accuracy-	Train: 79.83%.
Time taken: 0:02:22
======= Epoch 27 =======
Loss: 0.5709.	LR: 0.2099
Standard Accuracy-	Test: 82.72%.
Adversarial Accuracy-	Train: 79.82%.
Time taken: 0:02:22
======= Epoch 28 =======
Loss: 0.5715.	LR: 0.2096
Standard Accuracy-	Test: 84.74%.
Adversarial Accuracy-	Train: 79.99%.
Time taken: 0:02:22
======= Epoch 29 =======
Loss: 0.5660.	LR: 0.2092
Standard Accuracy-	Test: 81.27%.
Adversarial Accuracy-	Train: 80.03%.
Time taken: 0:02:22
======= Epoch 30 =======
Loss: 0.5634.	LR: 0.2085
Standard Accuracy-	Test: 84.93%.
Adversarial Accuracy-	Train: 80.44%.	Test: 74.93%.
Time taken: 0:03:09
======= Epoch 31 =======
Loss: 0.5616.	LR: 0.2077
Standard Accuracy-	Test: 84.66%.
Adversarial Accuracy-	Train: 80.39%.
Time taken: 0:02:22
======= Epoch 32 =======
Loss: 0.5557.	LR: 0.2067
Standard Accuracy-	Test: 75.48%.
Adversarial Accuracy-	Train: 80.49%.
Time taken: 0:02:22
======= Epoch 33 =======
Loss: 0.5575.	LR: 0.2055
Standard Accuracy-	Test: 77.04%.
Adversarial Accuracy-	Train: 80.50%.
Time taken: 0:02:22
======= Epoch 34 =======
Loss: 0.5573.	LR: 0.2042
Standard Accuracy-	Test: 84.00%.
Adversarial Accuracy-	Train: 80.36%.
Time taken: 0:02:22
======= Epoch 35 =======
Loss: 0.5488.	LR: 0.2026
Standard Accuracy-	Test: 84.36%.
Adversarial Accuracy-	Train: 80.70%.
Time taken: 0:02:22
======= Epoch 36 =======
Loss: 0.5523.	LR: 0.2009
Standard Accuracy-	Test: 82.48%.
Adversarial Accuracy-	Train: 80.54%.
Time taken: 0:02:22
======= Epoch 37 =======
Loss: 0.5483.	LR: 0.1990
Standard Accuracy-	Test: 84.02%.
Adversarial Accuracy-	Train: 80.61%.
Time taken: 0:02:22
======= Epoch 38 =======
Loss: 0.5437.	LR: 0.1970
Standard Accuracy-	Test: 84.36%.
Adversarial Accuracy-	Train: 80.86%.
Time taken: 0:02:22
======= Epoch 39 =======
Loss: 0.5398.	LR: 0.1948
Standard Accuracy-	Test: 83.41%.
Adversarial Accuracy-	Train: 81.03%.
Time taken: 0:02:22
======= Epoch 40 =======
Loss: 0.5424.	LR: 0.1925
Standard Accuracy-	Test: 80.12%.
Adversarial Accuracy-	Train: 81.10%.
Time taken: 0:02:22
======= Epoch 41 =======
Loss: 0.5372.	LR: 0.1899
Standard Accuracy-	Test: 82.17%.
Adversarial Accuracy-	Train: 81.01%.
Time taken: 0:02:22
======= Epoch 42 =======
Loss: 0.5355.	LR: 0.1873
Standard Accuracy-	Test: 81.56%.
Adversarial Accuracy-	Train: 81.25%.
Time taken: 0:02:22
======= Epoch 43 =======
Loss: 0.5324.	LR: 0.1845
Standard Accuracy-	Test: 82.48%.
Adversarial Accuracy-	Train: 81.16%.
Time taken: 0:02:22
======= Epoch 44 =======
Loss: 0.5330.	LR: 0.1815
Standard Accuracy-	Test: 85.23%.
Adversarial Accuracy-	Train: 81.32%.
Time taken: 0:02:22
======= Epoch 45 =======
Loss: 0.5254.	LR: 0.1785
Standard Accuracy-	Test: 81.05%.
Adversarial Accuracy-	Train: 81.58%.
Time taken: 0:02:22
======= Epoch 46 =======
Loss: 0.5260.	LR: 0.1753
Standard Accuracy-	Test: 84.28%.
Adversarial Accuracy-	Train: 81.43%.
Time taken: 0:02:22
======= Epoch 47 =======
Loss: 0.5209.	LR: 0.1719
Standard Accuracy-	Test: 83.62%.
Adversarial Accuracy-	Train: 81.61%.
Time taken: 0:02:22
======= Epoch 48 =======
Loss: 0.5184.	LR: 0.1685
Standard Accuracy-	Test: 83.49%.
Adversarial Accuracy-	Train: 81.78%.
Time taken: 0:02:22
======= Epoch 49 =======
Loss: 0.5166.	LR: 0.1649
Standard Accuracy-	Test: 79.51%.
Adversarial Accuracy-	Train: 81.81%.
Time taken: 0:02:22
======= Epoch 50 =======
Loss: 0.5162.	LR: 0.1613
Standard Accuracy-	Test: 86.21%.
Adversarial Accuracy-	Train: 81.80%.
Time taken: 0:02:22
======= Epoch 51 =======
Loss: 0.5119.	LR: 0.1575
Standard Accuracy-	Test: 83.01%.
Adversarial Accuracy-	Train: 81.86%.
Time taken: 0:02:22
======= Epoch 52 =======
Loss: 0.5062.	LR: 0.1536
Standard Accuracy-	Test: 85.38%.
Adversarial Accuracy-	Train: 82.18%.
Time taken: 0:02:22
======= Epoch 53 =======
Loss: 0.5076.	LR: 0.1497
Standard Accuracy-	Test: 86.25%.
Adversarial Accuracy-	Train: 82.15%.
Time taken: 0:02:22
======= Epoch 54 =======
Loss: 0.4943.	LR: 0.1457
Standard Accuracy-	Test: 87.44%.
Adversarial Accuracy-	Train: 82.55%.
Time taken: 0:02:22
======= Epoch 55 =======
Loss: 0.5009.	LR: 0.1416
Standard Accuracy-	Test: 83.11%.
Adversarial Accuracy-	Train: 82.43%.
Time taken: 0:02:22
======= Epoch 56 =======
Loss: 0.4909.	LR: 0.1374
Standard Accuracy-	Test: 85.83%.
Adversarial Accuracy-	Train: 82.85%.
Time taken: 0:02:22
======= Epoch 57 =======
Loss: 0.4921.	LR: 0.1332
Standard Accuracy-	Test: 84.87%.
Adversarial Accuracy-	Train: 82.54%.
Time taken: 0:02:22
======= Epoch 58 =======
Loss: 0.4867.	LR: 0.1290
Standard Accuracy-	Test: 84.63%.
Adversarial Accuracy-	Train: 82.89%.
Time taken: 0:02:22
======= Epoch 59 =======
Loss: 0.4831.	LR: 0.1247
Standard Accuracy-	Test: 86.20%.
Adversarial Accuracy-	Train: 83.00%.
Time taken: 0:02:22
======= Epoch 60 =======
Loss: 0.4775.	LR: 0.1203
Standard Accuracy-	Test: 86.31%.
Adversarial Accuracy-	Train: 83.10%.	Test: 74.03%.
Time taken: 0:03:09
======= Epoch 61 =======
Loss: 0.4756.	LR: 0.1160
Standard Accuracy-	Test: 85.49%.
Adversarial Accuracy-	Train: 83.30%.
Time taken: 0:02:22
======= Epoch 62 =======
Loss: 0.4744.	LR: 0.1116
Standard Accuracy-	Test: 86.31%.
Adversarial Accuracy-	Train: 83.05%.
Time taken: 0:02:22
======= Epoch 63 =======
Loss: 0.4672.	LR: 0.1072
Standard Accuracy-	Test: 85.66%.
Adversarial Accuracy-	Train: 83.47%.
Time taken: 0:02:22
======= Epoch 64 =======
Loss: 0.4597.	LR: 0.1028
Standard Accuracy-	Test: 83.05%.
Adversarial Accuracy-	Train: 83.70%.
Time taken: 0:02:22
======= Epoch 65 =======
Loss: 0.4598.	LR: 0.0984
Standard Accuracy-	Test: 86.63%.
Adversarial Accuracy-	Train: 83.66%.
Time taken: 0:02:22
======= Epoch 66 =======
Loss: 0.4473.	LR: 0.0940
Standard Accuracy-	Test: 87.02%.
Adversarial Accuracy-	Train: 84.25%.
Time taken: 0:02:22
======= Epoch 67 =======
Loss: 0.4447.	LR: 0.0897
Standard Accuracy-	Test: 75.62%.
Adversarial Accuracy-	Train: 84.27%.
Time taken: 0:02:22
======= Epoch 68 =======
Loss: 0.4389.	LR: 0.0853
Standard Accuracy-	Test: 87.40%.
Adversarial Accuracy-	Train: 84.42%.
Time taken: 0:02:22
======= Epoch 69 =======
Loss: 0.4351.	LR: 0.0810
Standard Accuracy-	Test: 88.25%.
Adversarial Accuracy-	Train: 84.71%.
Time taken: 0:02:22
======= Epoch 70 =======
Loss: 0.4209.	LR: 0.0768
Standard Accuracy-	Test: 86.52%.
Adversarial Accuracy-	Train: 84.94%.
Time taken: 0:02:22
======= Epoch 71 =======
Loss: 0.4195.	LR: 0.0725
Standard Accuracy-	Test: 88.62%.
Adversarial Accuracy-	Train: 84.95%.
Time taken: 0:02:22
======= Epoch 72 =======
Loss: 0.4117.	LR: 0.0684
Standard Accuracy-	Test: 82.56%.
Adversarial Accuracy-	Train: 85.42%.
Time taken: 0:02:22
======= Epoch 73 =======
Loss: 0.4035.	LR: 0.0643
Standard Accuracy-	Test: 87.94%.
Adversarial Accuracy-	Train: 85.60%.
Time taken: 0:02:22
======= Epoch 74 =======
Loss: 0.3918.	LR: 0.0603
Standard Accuracy-	Test: 88.13%.
Adversarial Accuracy-	Train: 85.94%.
Time taken: 0:02:22
======= Epoch 75 =======
Loss: 0.3802.	LR: 0.0563
Standard Accuracy-	Test: 89.24%.
Adversarial Accuracy-	Train: 86.29%.
Time taken: 0:02:22
======= Epoch 76 =======
Loss: 0.3752.	LR: 0.0525
Standard Accuracy-	Test: 89.73%.
Adversarial Accuracy-	Train: 86.69%.
Time taken: 0:02:22
======= Epoch 77 =======
Loss: 0.3617.	LR: 0.0487
Standard Accuracy-	Test: 89.32%.
Adversarial Accuracy-	Train: 86.98%.
Time taken: 0:02:22
======= Epoch 78 =======
Loss: 0.3484.	LR: 0.0451
Standard Accuracy-	Test: 89.11%.
Adversarial Accuracy-	Train: 87.56%.
Time taken: 0:02:22
======= Epoch 79 =======
Loss: 0.3394.	LR: 0.0415
Standard Accuracy-	Test: 88.72%.
Adversarial Accuracy-	Train: 87.84%.
Time taken: 0:02:22
======= Epoch 80 =======
Loss: 0.3258.	LR: 0.0381
Standard Accuracy-	Test: 90.65%.
Adversarial Accuracy-	Train: 88.41%.
Time taken: 0:02:22
======= Epoch 81 =======
Loss: 0.3088.	LR: 0.0347
Standard Accuracy-	Test: 88.69%.
Adversarial Accuracy-	Train: 88.85%.
Time taken: 0:02:22
======= Epoch 82 =======
Loss: 0.3007.	LR: 0.0315
Standard Accuracy-	Test: 91.50%.
Adversarial Accuracy-	Train: 89.17%.
Time taken: 0:02:22
======= Epoch 83 =======
Loss: 0.2793.	LR: 0.0285
Standard Accuracy-	Test: 90.58%.
Adversarial Accuracy-	Train: 89.98%.
Time taken: 0:02:22
======= Epoch 84 =======
Loss: 0.2615.	LR: 0.0255
Standard Accuracy-	Test: 91.43%.
Adversarial Accuracy-	Train: 90.70%.
Time taken: 0:02:22
======= Epoch 85 =======
Loss: 0.2449.	LR: 0.0227
Standard Accuracy-	Test: 91.63%.
Adversarial Accuracy-	Train: 91.24%.
Time taken: 0:02:22
======= Epoch 86 =======
Loss: 0.2234.	LR: 0.0200
Standard Accuracy-	Test: 91.19%.
Adversarial Accuracy-	Train: 92.02%.
Time taken: 0:02:22
======= Epoch 87 =======
Loss: 0.2030.	LR: 0.0175
Standard Accuracy-	Test: 90.67%.
Adversarial Accuracy-	Train: 92.55%.
Time taken: 0:02:22
======= Epoch 88 =======
Loss: 0.1853.	LR: 0.0152
Standard Accuracy-	Test: 91.76%.
Adversarial Accuracy-	Train: 93.44%.
Time taken: 0:02:22
======= Epoch 89 =======
Loss: 0.1654.	LR: 0.0130
Standard Accuracy-	Test: 92.59%.
Adversarial Accuracy-	Train: 94.01%.
Time taken: 0:02:22
======= Epoch 90 =======
Loss: 0.1405.	LR: 0.0109
Standard Accuracy-	Test: 92.68%.
Adversarial Accuracy-	Train: 94.95%.	Test: 84.29%.
Time taken: 0:03:09
======= Epoch 91 =======
Loss: 0.1149.	LR: 0.0091
Standard Accuracy-	Test: 92.86%.
Adversarial Accuracy-	Train: 95.94%.	Test: 84.96%.
Time taken: 0:03:09
======= Epoch 92 =======
Loss: 0.0933.	LR: 0.0074
Standard Accuracy-	Test: 93.35%.
Adversarial Accuracy-	Train: 96.73%.	Test: 85.79%.
Time taken: 0:03:09
======= Epoch 93 =======
Loss: 0.0733.	LR: 0.0058
Standard Accuracy-	Test: 93.43%.
Adversarial Accuracy-	Train: 97.42%.	Test: 86.06%.
Time taken: 0:03:09
======= Epoch 94 =======
Loss: 0.0551.	LR: 0.0045
Standard Accuracy-	Test: 93.88%.
Adversarial Accuracy-	Train: 98.18%.	Test: 86.31%.
Time taken: 0:03:09
======= Epoch 95 =======
Loss: 0.0383.	LR: 0.0033
Standard Accuracy-	Test: 93.80%.
Adversarial Accuracy-	Train: 98.80%.	Test: 86.43%.
Time taken: 0:03:09
======= Epoch 96 =======
Loss: 0.0290.	LR: 0.0023
Standard Accuracy-	Test: 94.04%.
Adversarial Accuracy-	Train: 99.13%.	Test: 86.96%.
Time taken: 0:03:09
======= Epoch 97 =======
Loss: 0.0236.	LR: 0.0015
Standard Accuracy-	Test: 94.06%.
Adversarial Accuracy-	Train: 99.34%.	Test: 87.17%.
Time taken: 0:03:09
======= Epoch 98 =======
Loss: 0.0185.	LR: 0.0008
Standard Accuracy-	Test: 94.10%.
Adversarial Accuracy-	Train: 99.52%.	Test: 87.17%.
Time taken: 0:03:09
======= Epoch 99 =======
Loss: 0.0167.	LR: 0.0004
Standard Accuracy-	Test: 94.15%.
Adversarial Accuracy-	Train: 99.59%.	Test: 87.16%.
Time taken: 0:03:09
======= Epoch 100 =======
Loss: 0.0162.	LR: 0.0001
Standard Accuracy-	Test: 94.21%.
Adversarial Accuracy-	Train: 99.59%.	Test: 87.16%.
Time taken: 0:03:09

Training completed.
Standard Accuracy-	Train: 99.96%.	Test: 94.10%.
Adversarial Accuracy-	Train: 99.59%.	Test: 87.17%.
Script Completed.
