Logging to file:  /rds/general/user/zf923/home/hat/log/at-cifar10-5/log-train.log
Using device: cuda
Files already downloaded and verified
Files already downloaded and verified
attack_eps= 0.0196078431372549
attack_step= 0.004901960784313725



Standard training for 0 epochs



Standard Accuracy-	Test: 9.257812%.
Adversarial training for 100 epochs
======= Epoch 1 =======
Loss: 1.8886.	LR: 0.0084
Standard Accuracy-	Test: 45.12%.
Adversarial Accuracy-	Train: 28.58%.
Time taken: 0:02:23
======= Epoch 2 =======
Loss: 1.7028.	LR: 0.0092
Standard Accuracy-	Test: 55.88%.
Adversarial Accuracy-	Train: 35.63%.
Time taken: 0:02:24
======= Epoch 3 =======
Loss: 1.5846.	LR: 0.0116
Standard Accuracy-	Test: 59.18%.
Adversarial Accuracy-	Train: 40.05%.
Time taken: 0:02:24
======= Epoch 4 =======
Loss: 1.5038.	LR: 0.0155
Standard Accuracy-	Test: 62.98%.
Adversarial Accuracy-	Train: 43.16%.
Time taken: 0:02:24
======= Epoch 5 =======
Loss: 1.4331.	LR: 0.0209
Standard Accuracy-	Test: 55.74%.
Adversarial Accuracy-	Train: 45.96%.
Time taken: 0:02:24
======= Epoch 6 =======
Loss: 1.3856.	LR: 0.0277
Standard Accuracy-	Test: 68.08%.
Adversarial Accuracy-	Train: 47.75%.
Time taken: 0:02:24
======= Epoch 7 =======
Loss: 1.3385.	LR: 0.0357
Standard Accuracy-	Test: 67.32%.
Adversarial Accuracy-	Train: 49.58%.
Time taken: 0:02:24
======= Epoch 8 =======
Loss: 1.3075.	LR: 0.0450
Standard Accuracy-	Test: 71.24%.
Adversarial Accuracy-	Train: 51.03%.
Time taken: 0:02:24
======= Epoch 9 =======
Loss: 1.2735.	LR: 0.0552
Standard Accuracy-	Test: 56.93%.
Adversarial Accuracy-	Train: 52.25%.
Time taken: 0:02:24
======= Epoch 10 =======
Loss: 1.2509.	LR: 0.0663
Standard Accuracy-	Test: 69.86%.
Adversarial Accuracy-	Train: 53.41%.
Time taken: 0:02:24
======= Epoch 11 =======
Loss: 1.2270.	LR: 0.0781
Standard Accuracy-	Test: 73.47%.
Adversarial Accuracy-	Train: 54.21%.
Time taken: 0:02:24
======= Epoch 12 =======
Loss: 1.2141.	LR: 0.0903
Standard Accuracy-	Test: 75.02%.
Adversarial Accuracy-	Train: 54.76%.
Time taken: 0:02:24
======= Epoch 13 =======
Loss: 1.2024.	LR: 0.1029
Standard Accuracy-	Test: 76.22%.
Adversarial Accuracy-	Train: 55.07%.
Time taken: 0:02:24
======= Epoch 14 =======
Loss: 1.1991.	LR: 0.1155
Standard Accuracy-	Test: 72.36%.
Adversarial Accuracy-	Train: 55.23%.
Time taken: 0:02:24
======= Epoch 15 =======
Loss: 1.1904.	LR: 0.1281
Standard Accuracy-	Test: 72.17%.
Adversarial Accuracy-	Train: 55.65%.
Time taken: 0:02:24
======= Epoch 16 =======
Loss: 1.1841.	LR: 0.1404
Standard Accuracy-	Test: 73.67%.
Adversarial Accuracy-	Train: 55.84%.
Time taken: 0:02:24
======= Epoch 17 =======
Loss: 1.1773.	LR: 0.1521
Standard Accuracy-	Test: 73.16%.
Adversarial Accuracy-	Train: 56.22%.
Time taken: 0:02:24
======= Epoch 18 =======
Loss: 1.1683.	LR: 0.1632
Standard Accuracy-	Test: 73.94%.
Adversarial Accuracy-	Train: 56.34%.
Time taken: 0:02:24
======= Epoch 19 =======
Loss: 1.1655.	LR: 0.1735
Standard Accuracy-	Test: 71.56%.
Adversarial Accuracy-	Train: 56.61%.
Time taken: 0:02:24
======= Epoch 20 =======
Loss: 1.1591.	LR: 0.1827
Standard Accuracy-	Test: 75.78%.
Adversarial Accuracy-	Train: 56.93%.
Time taken: 0:02:24
======= Epoch 21 =======
Loss: 1.1545.	LR: 0.1908
Standard Accuracy-	Test: 75.08%.
Adversarial Accuracy-	Train: 56.91%.
Time taken: 0:02:24
======= Epoch 22 =======
Loss: 1.1442.	LR: 0.1975
Standard Accuracy-	Test: 74.28%.
Adversarial Accuracy-	Train: 57.13%.
Time taken: 0:02:24
======= Epoch 23 =======
Loss: 1.1459.	LR: 0.2029
Standard Accuracy-	Test: 76.63%.
Adversarial Accuracy-	Train: 57.19%.
Time taken: 0:02:24
======= Epoch 24 =======
Loss: 1.1361.	LR: 0.2068
Standard Accuracy-	Test: 76.11%.
Adversarial Accuracy-	Train: 57.85%.
Time taken: 0:02:24
======= Epoch 25 =======
Loss: 1.1350.	LR: 0.2092
Standard Accuracy-	Test: 73.35%.
Adversarial Accuracy-	Train: 57.71%.
Time taken: 0:02:23
======= Epoch 26 =======
Loss: 1.1307.	LR: 0.2100
Standard Accuracy-	Test: 75.04%.
Adversarial Accuracy-	Train: 58.02%.
Time taken: 0:02:24
======= Epoch 27 =======
Loss: 1.1291.	LR: 0.2099
Standard Accuracy-	Test: 77.36%.
Adversarial Accuracy-	Train: 57.64%.
Time taken: 0:02:24
======= Epoch 28 =======
Loss: 1.1242.	LR: 0.2096
Standard Accuracy-	Test: 76.63%.
Adversarial Accuracy-	Train: 58.16%.
Time taken: 0:02:23
======= Epoch 29 =======
Loss: 1.1184.	LR: 0.2092
Standard Accuracy-	Test: 73.35%.
Adversarial Accuracy-	Train: 58.48%.
Time taken: 0:02:24
======= Epoch 30 =======
Loss: 1.1161.	LR: 0.2085
Standard Accuracy-	Test: 79.23%.
Adversarial Accuracy-	Train: 58.28%.	Test: 53.10%.
Time taken: 0:03:11
======= Epoch 31 =======
Loss: 1.1121.	LR: 0.2077
Standard Accuracy-	Test: 76.78%.
Adversarial Accuracy-	Train: 58.51%.
Time taken: 0:02:23
======= Epoch 32 =======
Loss: 1.1089.	LR: 0.2067
Standard Accuracy-	Test: 75.80%.
Adversarial Accuracy-	Train: 58.74%.
Time taken: 0:02:23
======= Epoch 33 =======
Loss: 1.1045.	LR: 0.2055
Standard Accuracy-	Test: 71.06%.
Adversarial Accuracy-	Train: 59.07%.
Time taken: 0:02:23
======= Epoch 34 =======
Loss: 1.1076.	LR: 0.2042
Standard Accuracy-	Test: 75.91%.
Adversarial Accuracy-	Train: 58.61%.
Time taken: 0:02:23
======= Epoch 35 =======
Loss: 1.1000.	LR: 0.2026
Standard Accuracy-	Test: 76.93%.
Adversarial Accuracy-	Train: 58.97%.
Time taken: 0:02:23
======= Epoch 36 =======
Loss: 1.0971.	LR: 0.2009
Standard Accuracy-	Test: 76.98%.
Adversarial Accuracy-	Train: 59.40%.
Time taken: 0:02:23
======= Epoch 37 =======
Loss: 1.0951.	LR: 0.1990
Standard Accuracy-	Test: 76.19%.
Adversarial Accuracy-	Train: 59.24%.
Time taken: 0:02:23
======= Epoch 38 =======
Loss: 1.0939.	LR: 0.1970
Standard Accuracy-	Test: 75.60%.
Adversarial Accuracy-	Train: 59.27%.
Time taken: 0:02:23
======= Epoch 39 =======
Loss: 1.0865.	LR: 0.1948
Standard Accuracy-	Test: 78.25%.
Adversarial Accuracy-	Train: 59.60%.
Time taken: 0:02:23
======= Epoch 40 =======
Loss: 1.0862.	LR: 0.1925
Standard Accuracy-	Test: 77.30%.
Adversarial Accuracy-	Train: 59.51%.
Time taken: 0:02:23
======= Epoch 41 =======
Loss: 1.0802.	LR: 0.1899
Standard Accuracy-	Test: 78.78%.
Adversarial Accuracy-	Train: 59.87%.
Time taken: 0:02:23
======= Epoch 42 =======
Loss: 1.0828.	LR: 0.1873
Standard Accuracy-	Test: 79.36%.
Adversarial Accuracy-	Train: 59.60%.
Time taken: 0:02:23
======= Epoch 43 =======
Loss: 1.0774.	LR: 0.1845
Standard Accuracy-	Test: 78.51%.
Adversarial Accuracy-	Train: 59.82%.
Time taken: 0:02:23
======= Epoch 44 =======
Loss: 1.0739.	LR: 0.1815
Standard Accuracy-	Test: 79.45%.
Adversarial Accuracy-	Train: 60.05%.
Time taken: 0:02:23
======= Epoch 45 =======
Loss: 1.0744.	LR: 0.1785
Standard Accuracy-	Test: 76.81%.
Adversarial Accuracy-	Train: 59.89%.
Time taken: 0:02:23
======= Epoch 46 =======
Loss: 1.0676.	LR: 0.1753
Standard Accuracy-	Test: 76.70%.
Adversarial Accuracy-	Train: 60.19%.
Time taken: 0:02:23
======= Epoch 47 =======
Loss: 1.0656.	LR: 0.1719
Standard Accuracy-	Test: 79.32%.
Adversarial Accuracy-	Train: 60.19%.
Time taken: 0:02:23
======= Epoch 48 =======
Loss: 1.0612.	LR: 0.1685
Standard Accuracy-	Test: 79.41%.
Adversarial Accuracy-	Train: 60.28%.
Time taken: 0:02:23
======= Epoch 49 =======
Loss: 1.0566.	LR: 0.1649
Standard Accuracy-	Test: 78.94%.
Adversarial Accuracy-	Train: 60.36%.
Time taken: 0:02:23
======= Epoch 50 =======
Loss: 1.0621.	LR: 0.1613
Standard Accuracy-	Test: 81.61%.
Adversarial Accuracy-	Train: 60.37%.
Time taken: 0:02:23
======= Epoch 51 =======
Loss: 1.0533.	LR: 0.1575
Standard Accuracy-	Test: 80.05%.
Adversarial Accuracy-	Train: 60.72%.
Time taken: 0:02:23
======= Epoch 52 =======
Loss: 1.0508.	LR: 0.1536
Standard Accuracy-	Test: 80.32%.
Adversarial Accuracy-	Train: 60.71%.
Time taken: 0:02:23
======= Epoch 53 =======
Loss: 1.0480.	LR: 0.1497
Standard Accuracy-	Test: 78.54%.
Adversarial Accuracy-	Train: 60.94%.
Time taken: 0:02:23
======= Epoch 54 =======
Loss: 1.0435.	LR: 0.1457
Standard Accuracy-	Test: 75.84%.
Adversarial Accuracy-	Train: 61.17%.
Time taken: 0:02:23
======= Epoch 55 =======
Loss: 1.0408.	LR: 0.1416
Standard Accuracy-	Test: 78.89%.
Adversarial Accuracy-	Train: 61.12%.
Time taken: 0:02:23
======= Epoch 56 =======
Loss: 1.0321.	LR: 0.1374
Standard Accuracy-	Test: 80.28%.
Adversarial Accuracy-	Train: 61.39%.
Time taken: 0:02:23
======= Epoch 57 =======
Loss: 1.0346.	LR: 0.1332
Standard Accuracy-	Test: 78.88%.
Adversarial Accuracy-	Train: 61.23%.
Time taken: 0:02:23
======= Epoch 58 =======
Loss: 1.0254.	LR: 0.1290
Standard Accuracy-	Test: 79.80%.
Adversarial Accuracy-	Train: 61.69%.
Time taken: 0:02:23
======= Epoch 59 =======
Loss: 1.0202.	LR: 0.1247
Standard Accuracy-	Test: 80.83%.
Adversarial Accuracy-	Train: 61.75%.
Time taken: 0:02:23
======= Epoch 60 =======
Loss: 1.0188.	LR: 0.1203
Standard Accuracy-	Test: 81.25%.
Adversarial Accuracy-	Train: 61.86%.	Test: 54.44%.
Time taken: 0:03:11
======= Epoch 61 =======
Loss: 1.0111.	LR: 0.1160
Standard Accuracy-	Test: 80.59%.
Adversarial Accuracy-	Train: 62.17%.
Time taken: 0:02:23
======= Epoch 62 =======
Loss: 1.0096.	LR: 0.1116
Standard Accuracy-	Test: 80.64%.
Adversarial Accuracy-	Train: 62.10%.
Time taken: 0:02:23
======= Epoch 63 =======
Loss: 1.0060.	LR: 0.1072
Standard Accuracy-	Test: 81.47%.
Adversarial Accuracy-	Train: 62.35%.
Time taken: 0:02:23
======= Epoch 64 =======
Loss: 0.9968.	LR: 0.1028
Standard Accuracy-	Test: 80.95%.
Adversarial Accuracy-	Train: 62.51%.
Time taken: 0:02:23
======= Epoch 65 =======
Loss: 0.9943.	LR: 0.0984
Standard Accuracy-	Test: 80.39%.
Adversarial Accuracy-	Train: 62.68%.
Time taken: 0:02:23
======= Epoch 66 =======
Loss: 0.9834.	LR: 0.0940
Standard Accuracy-	Test: 82.42%.
Adversarial Accuracy-	Train: 63.02%.
Time taken: 0:02:23
======= Epoch 67 =======
Loss: 0.9796.	LR: 0.0897
Standard Accuracy-	Test: 81.95%.
Adversarial Accuracy-	Train: 63.14%.
Time taken: 0:02:23
======= Epoch 68 =======
Loss: 0.9704.	LR: 0.0853
Standard Accuracy-	Test: 82.05%.
Adversarial Accuracy-	Train: 63.42%.
Time taken: 0:02:23
======= Epoch 69 =======
Loss: 0.9645.	LR: 0.0810
Standard Accuracy-	Test: 81.82%.
Adversarial Accuracy-	Train: 63.83%.
Time taken: 0:02:23
======= Epoch 70 =======
Loss: 0.9575.	LR: 0.0768
Standard Accuracy-	Test: 81.33%.
Adversarial Accuracy-	Train: 63.80%.
Time taken: 0:02:23
======= Epoch 71 =======
Loss: 0.9543.	LR: 0.0725
Standard Accuracy-	Test: 84.42%.
Adversarial Accuracy-	Train: 64.04%.
Time taken: 0:02:23
======= Epoch 72 =======
Loss: 0.9362.	LR: 0.0684
Standard Accuracy-	Test: 82.92%.
Adversarial Accuracy-	Train: 64.68%.
Time taken: 0:02:23
======= Epoch 73 =======
Loss: 0.9302.	LR: 0.0643
Standard Accuracy-	Test: 81.52%.
Adversarial Accuracy-	Train: 64.90%.
Time taken: 0:02:23
======= Epoch 74 =======
Loss: 0.9204.	LR: 0.0603
Standard Accuracy-	Test: 82.92%.
Adversarial Accuracy-	Train: 65.10%.
Time taken: 0:02:23
======= Epoch 75 =======
Loss: 0.9106.	LR: 0.0563
Standard Accuracy-	Test: 83.37%.
Adversarial Accuracy-	Train: 65.42%.
Time taken: 0:02:23
======= Epoch 76 =======
Loss: 0.8975.	LR: 0.0525
Standard Accuracy-	Test: 83.40%.
Adversarial Accuracy-	Train: 66.03%.
Time taken: 0:02:23
======= Epoch 77 =======
Loss: 0.8867.	LR: 0.0487
Standard Accuracy-	Test: 83.25%.
Adversarial Accuracy-	Train: 66.39%.
Time taken: 0:02:23
======= Epoch 78 =======
Loss: 0.8704.	LR: 0.0451
Standard Accuracy-	Test: 84.89%.
Adversarial Accuracy-	Train: 66.87%.
Time taken: 0:02:23
======= Epoch 79 =======
Loss: 0.8527.	LR: 0.0415
Standard Accuracy-	Test: 83.66%.
Adversarial Accuracy-	Train: 67.51%.
Time taken: 0:02:23
======= Epoch 80 =======
Loss: 0.8415.	LR: 0.0381
Standard Accuracy-	Test: 85.04%.
Adversarial Accuracy-	Train: 67.62%.
Time taken: 0:02:23
======= Epoch 81 =======
Loss: 0.8196.	LR: 0.0347
Standard Accuracy-	Test: 84.11%.
Adversarial Accuracy-	Train: 68.57%.
Time taken: 0:02:23
======= Epoch 82 =======
Loss: 0.8043.	LR: 0.0315
Standard Accuracy-	Test: 84.83%.
Adversarial Accuracy-	Train: 68.95%.
Time taken: 0:02:23
======= Epoch 83 =======
Loss: 0.7829.	LR: 0.0285
Standard Accuracy-	Test: 85.78%.
Adversarial Accuracy-	Train: 69.90%.
Time taken: 0:02:23
======= Epoch 84 =======
Loss: 0.7572.	LR: 0.0255
Standard Accuracy-	Test: 87.02%.
Adversarial Accuracy-	Train: 70.69%.
Time taken: 0:02:23
======= Epoch 85 =======
Loss: 0.7390.	LR: 0.0227
Standard Accuracy-	Test: 86.40%.
Adversarial Accuracy-	Train: 71.18%.
Time taken: 0:02:23
======= Epoch 86 =======
Loss: 0.7064.	LR: 0.0200
Standard Accuracy-	Test: 87.26%.
Adversarial Accuracy-	Train: 72.57%.
Time taken: 0:02:23
======= Epoch 87 =======
Loss: 0.6828.	LR: 0.0175
Standard Accuracy-	Test: 86.14%.
Adversarial Accuracy-	Train: 73.17%.
Time taken: 0:02:23
======= Epoch 88 =======
Loss: 0.6535.	LR: 0.0152
Standard Accuracy-	Test: 87.84%.
Adversarial Accuracy-	Train: 74.21%.
Time taken: 0:02:23
======= Epoch 89 =======
Loss: 0.6189.	LR: 0.0130
Standard Accuracy-	Test: 87.71%.
Adversarial Accuracy-	Train: 75.52%.
Time taken: 0:02:23
======= Epoch 90 =======
Loss: 0.5848.	LR: 0.0109
Standard Accuracy-	Test: 88.14%.
Adversarial Accuracy-	Train: 76.83%.	Test: 62.85%.
Time taken: 0:03:11
======= Epoch 91 =======
Loss: 0.5436.	LR: 0.0091
Standard Accuracy-	Test: 88.40%.
Adversarial Accuracy-	Train: 78.10%.	Test: 63.00%.
Time taken: 0:03:11
======= Epoch 92 =======
Loss: 0.5053.	LR: 0.0074
Standard Accuracy-	Test: 89.11%.
Adversarial Accuracy-	Train: 79.48%.	Test: 62.75%.
Time taken: 0:03:11
======= Epoch 93 =======
Loss: 0.4623.	LR: 0.0058
Standard Accuracy-	Test: 88.94%.
Adversarial Accuracy-	Train: 81.47%.	Test: 63.59%.
Time taken: 0:03:11
======= Epoch 94 =======
Loss: 0.4205.	LR: 0.0045
Standard Accuracy-	Test: 89.29%.
Adversarial Accuracy-	Train: 82.87%.	Test: 63.07%.
Time taken: 0:03:11
======= Epoch 95 =======
Loss: 0.3790.	LR: 0.0033
Standard Accuracy-	Test: 89.45%.
Adversarial Accuracy-	Train: 84.58%.	Test: 63.17%.
Time taken: 0:03:11
======= Epoch 96 =======
Loss: 0.3400.	LR: 0.0023
Standard Accuracy-	Test: 89.69%.
Adversarial Accuracy-	Train: 86.11%.	Test: 63.32%.
Time taken: 0:03:11
======= Epoch 97 =======
Loss: 0.3085.	LR: 0.0015
Standard Accuracy-	Test: 89.84%.
Adversarial Accuracy-	Train: 87.55%.	Test: 63.79%.
Time taken: 0:03:14
======= Epoch 98 =======
Loss: 0.2876.	LR: 0.0008
Standard Accuracy-	Test: 89.77%.
Adversarial Accuracy-	Train: 88.31%.	Test: 63.65%.
Time taken: 0:03:11
======= Epoch 99 =======
Loss: 0.2735.	LR: 0.0004
Standard Accuracy-	Test: 89.84%.
Adversarial Accuracy-	Train: 88.73%.	Test: 63.39%.
Time taken: 0:03:11
======= Epoch 100 =======
Loss: 0.2676.	LR: 0.0001
Standard Accuracy-	Test: 89.96%.
Adversarial Accuracy-	Train: 88.95%.	Test: 63.64%.
Time taken: 0:03:11

Training completed.
Standard Accuracy-	Train: 98.81%.	Test: 89.84%.
Adversarial Accuracy-	Train: 88.95%.	Test: 63.79%.
Script Completed.
